import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Calendar } from "@/components/ui/calendar";
import { motion } from "framer-motion";

export default function SmartGardenApp() {
  const [cameraAngle, setCameraAngle] = useState(0);
  const [selectedDate, setSelectedDate] = useState<Date | undefined>();
  const [reminders, setReminders] = useState<{ [key: string]: string }>({});
  const [isFrontCamera, setIsFrontCamera] = useState(false);

  const handleRotate = (direction: "left" | "right") => {
    setCameraAngle((prev) => prev + (direction === "left" ? -15 : 15));
  };

  const handleDateSelect = (date: Date) => {
    setSelectedDate(date);
  };

  const handleAddReminder = () => {
    if (selectedDate) {
      const dateKey = selectedDate.toISOString().split("T")[0];
      setReminders({ ...reminders, [dateKey]: "–ü–æ–ª–∏–≤ —Ä–∞—Å—Ç–µ–Ω–∏–π" });
    }
  };

  const toggleCamera = () => {
    setIsFrontCamera((prev) => !prev);
  };

  return (
    <div className="p-6 space-y-6 bg-green-50 text-green-900">
      <h1 className="text-4xl font-bold text-center text-green-700">TopyraqLab</h1>
      <h2 className="text-2xl font-bold text-center">–£–º–Ω—ã–π —Å–∞–¥</h2>
      
      {/* –ö–∞–º–µ—Ä–∞ */}
      <Card className="bg-white shadow-lg rounded-2xl">
        <CardContent className="flex flex-col items-center p-4">
          <motion.div animate={{ rotate: cameraAngle }} className="w-40 h-40 bg-green-100 flex items-center justify-center rounded-lg">
            {isFrontCamera ? "üåø –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞" : "üì∑ –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞"}
          </motion.div>
          <div className="mt-2 space-x-2">
            <Button onClick={() => handleRotate("left")} className="bg-green-500 hover:bg-green-600">‚¨ÖÔ∏è</Button>
            <Button onClick={() => handleRotate("right")} className="bg-green-500 hover:bg-green-600">‚û°Ô∏è</Button>
            <Button onClick={toggleCamera} className="ml-2 bg-green-500 hover:bg-green-600">üîÑ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É</Button>
          </div>
        </CardContent>
      </Card>
      
      {/* –ö–∞–ª–µ–Ω–¥–∞—Ä—å */}
      <Card className="bg-white shadow-lg rounded-2xl">
        <CardContent className="p-4">
          <Calendar mode="single" selected={selectedDate} onSelect={handleDateSelect} />
          <Button onClick={handleAddReminder} className="mt-2 w-full bg-green-500 hover:bg-green-600">–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</Button>
        </CardContent>
      </Card>

      {/* –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ */}
      <Card className="bg-white shadow-lg rounded-2xl">
        <CardContent className="p-4">
          <h2 className="text-xl font-semibold text-green-700">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
          {selectedDate ? (
            <p className="mt-2 text-green-800">{reminders[selectedDate.toISOString().split("T")[0]] || "–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π."}</p>
          ) : (
            <p className="mt-2 text-green-800">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.</p>
          )}
        </CardContent>
      </Card>
    </div>
  );
}
